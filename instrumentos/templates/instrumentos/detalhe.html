{% extends 'base.html' %}

{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h2>{{ instrumento.nome }}</h2>
        <div>
            <a href="{% url 'editar_instrumento' pk=instrumento.pk %}" class="btn btn-primary">Editar</a>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">
                Excluir
            </button>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h4>Informações</h4>
                <dl class="row">
                    <dt class="col-sm-4">Categoria</dt>
                    <dd class="col-sm-8">{{ instrumento.categoria }}</dd>

                    <dt class="col-sm-4">Modelo</dt>
                    <dd class="col-sm-8">{{ instrumento.modelo }}</dd>

                    <dt class="col-sm-4">Ano de Fabricação</dt>
                    <dd class="col-sm-8">{{ instrumento.ano_fabricacao }}</dd>

                    <dt class="col-sm-4">Preço</dt>
                    <dd class="col-sm-8">R$ {{ instrumento.preco }}</dd>

                    <dt class="col-sm-4">Número de Série</dt>
                    <dd class="col-sm-8">{{ instrumento.numero_serie|default:"Não informado" }}</dd>

                    <dt class="col-sm-4">Estado</dt>
                    <dd class="col-sm-8">{{ instrumento.get_estado_conservacao_display }}</dd>

                    <dt class="col-sm-4">Data de Aquisição</dt>
                    <dd class="col-sm-8">{{ instrumento.data_aquisicao }}</dd>
                </dl>

                <h4>Características</h4>
                <p>{{ instrumento.caracteristicas|linebreaks }}</p>
            </div>
            <div class="col-md-6">
                <h4>Fotos</h4>
                <div id="instrumentoCarousel" class="carousel slide" data-bs-ride="carousel">
                    <div class="carousel-inner">
                        {% for foto in instrumento.fotos.all %}
                        <div class="carousel-item {% if forloop.first %}active{% endif %}">
                            <img src="{{ foto.imagem.url }}" class="d-block w-100" alt="{{ foto.descricao }}">
                        </div>
                        {% empty %}
                        <p>Nenhuma foto cadastrada</p>
                        {% endfor %}
                    </div>
                    {% if instrumento.fotos.count > 1 %}
                    <button class="carousel-control-prev" type="button" data-bs-target="#instrumentoCarousel"
                        data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#instrumentoCarousel"
                        data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de confirmação de exclusão -->
<div class="modal fade" id="deleteModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirmar Exclusão</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                Tem certeza que deseja excluir o instrumento "{{ instrumento.nome }}"?
            </div>
            <div class="modal-footer">
                <form method="post" action="{% url 'excluir_instrumento' pk=instrumento.pk %}">
                    {% csrf_token %}
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-danger">Confirmar Exclusão</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}